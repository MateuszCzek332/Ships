<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ships</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body style="padding: 0; margin:0;">

    <div class="session">
        <div class="left"></div>
        <form action="" class="log-in" autocomplete="off">
            <h4>Ships</h4>
            <p>Log in to your account</p>
            <div class="floating-label">
                <input placeholder="Login" name="login" id="login" autocomplete="off">
                <label for="login">Login:</label>
            </div>
            <div class="floating-label">
                <input placeholder="Password" type="password" name="password" id="pass" autocomplete="off">
                <label for="password">Password:</label>
            </div>
            <button type="submit" style="margin: 18px auto auto auto;" onClick="return false;" id="logMe">Log
                in</button>
            <button type="submit" style="margin: 8px auto auto auto;" id="register"><a href="register.html"
                    style="text-decoration: none; color: white;">Registration</a></button>
            <a href="https://codepen.io/elujambio/pen/yjwzGP" style="display: none;" class="discrete"
                target="_blank">Basic version</a>
        </form>
    </div>

    <script>
        let login = () => { //Wysyłanie danych na serwer, funkcja checkStatus sprawdza odpowiedź

            let data = {
                userName: document.getElementById("login").value,
                pass: document.getElementById("pass").value
            }

            const options = {
                method: "POST",
                body: JSON.stringify(data)
            }

            fetch("/loginUser", options)
                .then(response => response.json())
                .then(mess => checkStatus(mess))
                .catch(error => console.log(error))
        }

        checkStatus = (data) => { //Otrzymanie odpowiedzi od serwera o poprawności logowania
            console.log(data)
            if (data.status) {
                console.log("Logowanie udane")
                window.location.href = "profile.html?user=" + data.userName
            }
            else
                console.log("Zły login i/lub hasło")
        }

        document.getElementById("logMe").onclick = () => {
            login()
        }

    </script>

</body>

</html>