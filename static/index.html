<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body style="padding: 0; margin:0;">
    <h1>Statki by MC & MP</h1>
    <h2>Logowanie</h2>
    <p> Login: <input type="text" id="login"></p>
    <p> Hasło: <input type="password" id="pass"></p>
    <button id="logMe" >Zaloguj się</button>
    <br><br>
    <a href="register.html"> Zarejestruj się </a>

    <script>    

        let login = () =>{ // wysylanie danych na serwer, funkcja checkStatus sprawdza odpowiedz 

            let data = {
                userName: document.getElementById("login").value,
                pass: document.getElementById("pass").value
            }

            const options = {
                method: "POST",
                body: JSON.stringify(data)
            };

            fetch("/loginUser", options)
                .then(response => response.json())
                .then(mess => checkStatus(mess))
                .catch(error => console.log(error));

        }

        checkStatus = (data) => { //otrzymanie odpowiedzi od serwera o poprawnosci logowania
            console.log(data)
            if(data.status){
                console.log("Logowanie udane")
                window.location.href = "profile.html?user=" + data.userName
            }
            else
                console.log("Zły login i/lub hasło")
        }

        document.getElementById("logMe").onclick = () =>{
            login();

        }
    
    </script>

</body>
</html>