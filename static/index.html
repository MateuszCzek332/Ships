<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Ships</title>

    <link rel="stylesheet" href="css/style.css">
</head>

<body style="padding: 0; margin:0;">
    <div class="session">
        <form action="" class="log-in" autocomplete="off">
            <h4>Ships</h4>
            <p>Log in to your account</p>
            <div class="floating-label">
                <input placeholder="Login" name="login" style="margin-top: 27px;" id="login" autocomplete="off">
                <label style="margin-top: 10px;" for="login">Login:</label>
            </div>
            <div class="floating-label">
                <input placeholder="Password" type="password" name="password" id="pass" autocomplete="off">
                <label for="password">Password:</label>
                <div class="icon">
                    <?xml version="1.0" encoding="UTF-8"?>
                    <svg enable-background="new 0 0 24 24" version="1.1" viewBox="0 0 24 24" xml:space="preserve"
                        xmlns="http://www.w3.org/2000/svg">
                        <style type="text/css">
                            .st0 {
                                fill: none;
                            }

                            .st1 {
                                fill: #010101;
                            }
                        </style>
                        <rect class="st0" width="24" height="24" />
                        <path class="st1" d="M19,21H5V9h14V21z M6,20h12V10H6V20z" />
                        <path class="st1"
                            d="M16.5,10h-1V7c0-1.9-1.6-3.5-3.5-3.5S8.5,5.1,8.5,7v3h-1V7c0-2.5,2-4.5,4.5-4.5s4.5,2,4.5,4.5V10z" />
                        <path class="st1"
                            d="m12 16.5c-0.8 0-1.5-0.7-1.5-1.5s0.7-1.5 1.5-1.5 1.5 0.7 1.5 1.5-0.7 1.5-1.5 1.5zm0-2c-0.3 0-0.5 0.2-0.5 0.5s0.2 0.5 0.5 0.5 0.5-0.2 0.5-0.5-0.2-0.5-0.5-0.5z" />
                    </svg>
                </div>
            </div>
            <button type="submit" style="margin: 24px auto auto auto;" onClick="return false;" id="logMe">Log
                in</button>
            <button style="margin: -1px auto auto auto;" id="register"><a href="register.html"
                    style="text-decoration: none; color: white;">Registration</a></button>
            <a href="https://codepen.io/elujambio/pen/yjwzGP" style="display: none;" class="discrete"
                target="_blank">Basic version</a>
        </form>
        <div class="right"></div>
    </div>

    <script>
        let login = () => { //Wysyłanie danych na serwer, funkcja checkStatus sprawdza odpowiedź
            let data = {
                userName: document.getElementById("login").value,
                pass: document.getElementById("pass").value
            }

            const options = {
                method: "POST",
                body: JSON.stringify(data)
            }

            fetch("/loginUser", options)
                .then(response => response.json())
                .then(mess => checkStatus(mess))
                .catch(error => console.log(error))
        }

        checkStatus = (data) => { //Otrzymanie odpowiedzi od serwera o poprawności logowania
            console.log(data)
            if (data.status) {
                console.log("Logowanie udane")
                window.location.href = "profile.html?user=" + data.userName
            }
            else
                console.log("Zły login i/lub hasło")
        }

        document.getElementById("logMe").onclick = () => {
            login()
        }
    </script>
</body>

</html>